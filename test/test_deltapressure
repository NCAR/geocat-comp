
from unittest import TestCase
import sys
from abc import ABCMeta
from geocat.comp.delta_pressure import _calc_deltapressure_1D
import numpy as np
import xarray as xr

# Import from directory structure if coverage test, or from installed
# packages otherwise
if "--cov" in str(sys.argv):
    from src.geocat.comp.stats import eofunc, eofunc_eofs, eofunc_pcs, eofunc_ts, pearson_r
else:
    from geocat.comp.stats import eofunc, eofunc_eofs, eofunc_pcs, eofunc_ts, pearson_r

Class TestDeltaPressure(TestCase):

    def test_deltapressure_1D():
        pressure_lev = [1, 2, 50, 100, 200, 500, 700, 1000]
        surface_pressure = 1018
        
        pressure_top = min(pressure_lev)
        delta_pressure = _calc_deltapressure_1D(pressure_lev, surface_pressure)
        assert sum(delta_pressure) == surface_pressure - pressure_top
